<!DOCTYPE html>
<meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
<style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>

<h2>Searchs for <%= @query %> </h2>

<%= form_tag("/venues/#{@group.id}", method: "post") do %>
<%= select("post", "event_id", @group.events.collect {|p| [ p.name, p.id ]}, {include_blank: true}) %>

<% @venues.each do |venue| %>
  <h3><%= venue["venue"]["name"]%></h3>
  <p><%= venue["venue"]["location"]["address"] %></p>
  <%= check_box_tag 'venue_ids[]' , "#{venue["venue"]['name']}?#{venue["venue"]['location']['address']}"%>
  <% end %>

<div>
<%= submit_tag("Add Restaurants to Event") %>
</div>
<% end %>
<div id="map"></div>
<script>
      function initMap() {
        var myLatLng = {lat: <%= @x %>, lng: <%= @y %>};
        var map = new google.maps.Map(document.getElementById('map'), {
          center: myLatLng,
          zoom: 14
        });
        var center = new google.maps.Marker({
          position: myLatLng,
          map: map
        });
        center.setMap(map);
        <% @venues.each do |venue| %>
        var coord = {lat: <%= venue["venue"]["location"]["lat"] %>, lng: <%= venue["venue"]["location"]["lng"] %>}
        var marker = new google.maps.Marker({
          position: coord,
          map: map
        });
        marker.setMap(map);
        <% end %>
      }
    </script>
    <script src="<%= @url %>" async defer></script>
</body>